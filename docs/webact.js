var fe=Object.defineProperty;var me=Object.prototype.hasOwnProperty;var V=Object.getOwnPropertySymbols,Se=Object.prototype.propertyIsEnumerable;var X=(s,t,a)=>t in s?fe(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,H=(s,t)=>{for(var a in t||(t={}))me.call(t,a)&&X(s,a,t[a]);if(V)for(var a of V(t))Se.call(t,a)&&X(s,a,t[a]);return s};(function(){"use strict";if("adoptedStyleSheets"in document)return;var s="ShadyCSS"in window&&!window.ShadyCSS.nativeShadow,t=[],a=[],r=new WeakMap,e=new WeakMap,l=new WeakMap,m=new WeakMap,g=new WeakMap,y={loaded:!1},v={body:null,CSSStyleSheet:null},W=CSSStyleSheet,re=/@import\surl(.*?);/gi;function I(n){return n instanceof W||n instanceof v.CSSStyleSheet}function se(n,o){var i=o===document?"Document":"ShadowRoot";if(!Array.isArray(n))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+i+": Iterator getter is not callable.");if(!n.every(I))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+i+": Failed to convert value to 'CSSStyleSheet'");var c=n.filter(function(h,d){return n.indexOf(h)===d});return r.set(o,c),c}function $(){return document.readyState==="loading"}function z(n){return r.get(n.parentNode===document.documentElement?document:n)}function B(n){var o=n.match(re,"")||[],i=n;return o.length&&(console.warn("@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418"),o.forEach(function(c){i=i.replace(c,"")})),i}var oe=["addImport","addPageRule","addRule","deleteRule","insertRule","removeImport","removeRule"],ie=["replace","replaceSync"];function G(n){ie.forEach(function(o){n[o]=function(){return L.prototype[o].apply(this,arguments)}}),oe.forEach(function(o){var i=n[o];n[o]=function(){var c=arguments,h=i.apply(this,c);if(e.has(this)){var d=e.get(this),p=d.adopters,S=d.actions;p.forEach(function(f){f.sheet&&f.sheet[o].apply(f.sheet,c)}),S.push([o,c])}return h}})}function J(n){var o=e.get(n),i=o.adopters,c=o.basicStyleElement;i.forEach(function(h){h.innerHTML=c.innerHTML})}var L=function(){function n(){var i=document.createElement("style");y.loaded?v.body.appendChild(i):(document.head.appendChild(i),i.disabled=!0,t.push(i));var c=i.sheet;return e.set(c,{adopters:new Map,actions:[],basicStyleElement:i}),c}var o=n.prototype;return o.replace=function(c){var h=this,d=B(c);return new Promise(function(p,S){if(e.has(h)){var f=e.get(h),u=f.basicStyleElement;u.innerHTML=d,p(u.sheet),J(h)}else S(new Error("Can't call replace on non-constructed CSSStyleSheets."))})},o.replaceSync=function(c){var h=B(c);if(e.has(this)){var d=e.get(this),p=d.basicStyleElement;return p.innerHTML=h,J(this),p.sheet}else throw new Error("Failed to execute 'replaceSync' on 'CSSStyleSheet': Can't call replaceSync on non-constructed CSSStyleSheets.")},n}();Object.defineProperty(L,Symbol.hasInstance,{configurable:!0,value:I});function O(n){for(var o=document.createDocumentFragment(),i=z(n),c=m.get(n),h=0,d=i.length;h<d;h++){var p=e.get(i[h]),S=p.adopters,f=p.basicStyleElement,u=S.get(n);u?(c.disconnect(),o.appendChild(u),(!u.innerHTML||u.sheet&&!u.sheet.cssText)&&(u.innerHTML=f.innerHTML),c.observe()):(u=document.createElement("style"),u.innerHTML=f.innerHTML,l.set(u,n),g.set(u,0),S.set(n,u),o.appendChild(u)),n===document.head&&a.push(u)}n.insertBefore(o,n.firstChild);for(var w=0,D=i.length;w<D;w++){var C=e.get(i[w]),M=C.adopters,b=C.actions,E=M.get(n),de=g.get(E);if(b.length>0){for(var A=de,ue=b.length;A<ue;A++){var Q=b[A],le=Q[0],pe=Q[1];E.sheet[le].apply(E.sheet,pe)}g.set(E,b.length-1)}}}function ae(n,o){for(var i=z(n),c=0,h=o.length;c<h;c++)if(!(i.indexOf(o[c])>-1)){var d=e.get(o[c]),p=d.adopters,S=m.get(n),f=p.get(n);f||(f=p.get(document.head)),S.disconnect(),f.parentNode.removeChild(f),S.observe()}}function ce(n){for(var o=0,i=n.length;o<i;o++){for(var c=n[o],h=c.addedNodes,d=c.removedNodes,p=0,S=d.length;p<S;p++){var f=l.get(d[p]);f&&O(f)}if(!s)for(var u=0,w=h.length;u<w;u++)for(var D=document.createNodeIterator(h[u],NodeFilter.SHOW_ELEMENT,function(M){return M.shadowRoot&&M.shadowRoot.adoptedStyleSheets.length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},null,!1),C=void 0;C=D.nextNode();)O(C.shadowRoot)}}function Y(n){var o=new MutationObserver(ce),i={observe:function(){o.observe(n,{childList:!0,subtree:!0})},disconnect:function(){o.disconnect()}};m.set(n,i),i.observe()}function Z(){var n=document.createElement("iframe");n.hidden=!0,document.body.appendChild(n),v.body=n.contentWindow.document.body,v.CSSStyleSheet=n.contentWindow.CSSStyleSheet,G(n.contentWindow.CSSStyleSheet.prototype),Y(document.body),y.loaded=!0;for(var o=document.createDocumentFragment(),i=0,c=t.length;i<c;i++)t[i].disabled=!1,o.appendChild(t[i]);v.body.appendChild(o);for(var h=0,d=a.length;h<d;h++)o.appendChild(a[h]);document.body.insertBefore(o,document.body.firstChild),t.length=0,a.length=0}function he(){var n={configurable:!0,get:function(){return r.get(this)||[]},set:function(c){var h=r.get(this)||[];se(c,this);var d=this===document?$()?this.head:this.body:this,p="isConnected"in d?d.isConnected:document.body.contains(d);window.requestAnimationFrame(function(){p&&(O(d),ae(d,h))})}};if(Object.defineProperty(Document.prototype,"adoptedStyleSheets",n),typeof ShadowRoot!="undefined"){var o=Element.prototype.attachShadow;Element.prototype.attachShadow=function(){var i=s?this:o.apply(this,arguments);return Y(i),i},Object.defineProperty(ShadowRoot.prototype,"adoptedStyleSheets",n)}}G(W.prototype),window.CSSStyleSheet=L,he(),$()?document.addEventListener("DOMContentLoaded",Z):Z()})();function ye(s){return s.replace(/(-)([a-z])/g,t=>t[1].toUpperCase())}function F(s){return s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function _(s){return s?Array.from(s).reduce((t,{localName:a,value:r})=>H(H({},t),{[ye(a)]:r}),{}):{}}function x(s){return document.createRange().createContextualFragment(s)}function K(s,...t){let a=Array.isArray(s)?s.reduce((e,l,m)=>e+(t[m]?l+t[m]:l),""):s,r=new CSSStyleSheet;return r.replace(a),r}function k(s,...t){let a=Array.isArray(s)?s.reduce((r,e,l)=>r+(t[l]?e+t[l]:e),""):s;return x(a)}var j={},ge={},N=class extends HTMLElement{constructor(t){super();t?this.componentPath=t:(console.warn("You did not send a path to the super method in your constructor. Thus CSS and HTML cannot be read for this component.",this),console.warn("If shipping for modern browser, then call super with import.meta.url. If not, specify a path that is similar to import.meta.url yourself."),console.warn("Should be the path to the component you are making."))}$(t){return this._sDOM.querySelector(t)}get cssPath(){return this.componentPath&&this.componentPath.replace(/\.(html|js)/gi,".css")}get htmlPath(){return this.componentPath&&this.componentPath.replace(/\.(css|js)/gi,".html")}get props(){return _(this.attributes)}async _render(){if(!ge[this.cssPath]&&this.cssPath){let r=await this.fetchCSSAsStyleSheet();this._sDOM.adoptedStyleSheets=[r]}let a=this.render(this.props);return x(a)}async fetchHTMLAsDocFrag(){let t=await fetch(this.htmlPath);if(t.ok){let a=await t.text();return x(a)}throw new Error("Fetch failed")}async fetchCSSAsStyleSheet(){let t=new CSSStyleSheet,a=await fetch(this.cssPath);if(a.ok&&a.headers.get("content-type").indexOf("text/css")!==-1){let r=await a.text();await t.replace(r)}return t}async _renderHTMLFile(){let t=btoa(this.componentPath);j[t]||(j[t]=Promise.all([this.fetchHTMLAsDocFrag(),this.fetchCSSAsStyleSheet()]));let[a,r]=await j[t];return this._sDOM.adoptedStyleSheets=[r],a.cloneNode(!0)}componentDidMount(){}async connectedCallback(){this._sDOM=this.attachShadow({mode:"closed"});let t;this.render?t=await this._render():this.componentPath?t=await this._renderHTMLFile():console.error("No render function or component path found for static html/css."),this._sDOM.innerHTML=null,this._sDOM.appendChild(t),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.componentDidMount&&this.componentDidMount()})})}};function ee(s,{name:t}={name:void 0}){let a="is"in s?s.is:s.prototype.constructor.name,r=t||F(a);return customElements.define(r,s),r}var te=[],q=new Map,P=new Map,R=new Map,T=new Map,U=new Map;function ve(s,{metaUrl:t,observedAttributes:a,kebabName:r}){return class extends HTMLElement{constructor(){super();this._postRender=void 0,this._propsChanged=void 0,this._hmrUpdate=!1,this._componentPath=t,this._hasRendered=!1,document.addEventListener("esm-hmr:webact-function-component",()=>{this._hmrUpdate=!0,s=q.has(r)?q.get(r):s,this._render()})}set _html(e){if(!P.has(r)||this._hmrUpdate){let l=document.createElement("template");l.content.appendChild(e),P.set(r,l)}}get _html(){return P.has(r)?P.get(r).content.cloneNode(!0):null}set _css(e){(!R.has(r)||this._hmrUpdate)&&R.set(r,e)}get _css(){return R.has(r)?R.get(r):null}get cssPath(){return this._componentPath&&this._componentPath.replace(/\.(html|js)/gi,".css")}get htmlPath(){return this._componentPath&&this._componentPath.replace(/\.(css|js)/gi,".html")}static get observedAttributes(){return a}async _render(e){this._rendering=s.apply(this.customThis,[e]),this._rendering instanceof Promise&&await this._rendering,this._css?requestAnimationFrame(()=>{this._sDOM.adoptedStyleSheets=[this._css]}):console.warn(`<${r}>: Missing CSS. Will render without it.`),this._html?requestAnimationFrame(()=>this._sDOM.appendChild(this._html)):console.warn(`<${r}>: Missing HTML. Will render without it.`),this._postRender instanceof Function&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{this._postRender(),this._hmrUpdate=!1,this._hasRendered=!0})})}get _props(){return _(this.attributes)}get customThis(){return{html:(e,...l)=>{if(!(this._html!==null&&this._hmrUpdate===!1))return this._html=k(e,...l),this._html},css:(e,...l)=>{if(!(this._css!==null&&this._hmrUpdate===!1))return this._css=K(e,...l),this._css},useHTML:async e=>{if(U.has(r))return U.get(r);if(e=e||this.htmlPath,!e)return;e instanceof URL&&(e=e.toString());let m=(async()=>{let y=await(await fetch(e)).text();this.customThis.html([y])})();return U.set(r,m),m},useCSS:async e=>{if(T.has(r))return T.get(r);if(e=e||this.cssPath,!e)return;e instanceof URL&&(e=e.toString());let m=(async()=>{let y=await(await fetch(e)).text();this.customThis.css([y]),T.delete(r)})();return T.set(r,m),m},postRender:e=>{this._postRender=e},deRender:e=>{this._deRender=e},propsChanged:e=>{this._propsChanged=e},$:e=>e===void 0||e===":host"?this:e===":root"?this._sDOM:this._sDOM.querySelector(e),$$:e=>this._sDOM.querySelectorAll(e)}}async attributeChangedCallback(){this._rendering instanceof Promise&&await this._rendering,requestAnimationFrame(()=>{this._propsChanged instanceof Function?this._propsChanged(_(this.attributes)):console.error(`
            <${r}>: Attribute has changed and you are observing attributes, but not handling them in a propsChanged handler.
            Remove observedAttributes or or actually use them.
          `)})}async connectedCallback(){this._sDOM=this.attachShadow({mode:"closed"}),this._render(this._props)}disconnectedCallback(){this._deRender&&this._deRender()}}}function ne(s,{metaUrl:t,observedAttributes:a,name:r}={metaUrl:void 0,observedAttributes:[],name:void 0}){let e=r||F(s.name);if(customElements.get(e))if(te.includes(e))q.set(e,s),document.dispatchEvent(new CustomEvent("esm-hmr:webact-function-component"));else throw new Error(`
        Some else has already registered <${e}> in the custom element registry.
      `);else{let l=ve(s,{metaUrl:t,observedAttributes:a,kebabName:e});customElements.define(e,l),te.push(e)}return e}export{N as Component,ee as registerComponent,ne as registerFunctionComponent};
//# sourceMappingURL=index.js.map
