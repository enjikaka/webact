function e(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,a){var i=t.apply(n,r);function s(t){e(i,o,a,s,c,"next",t)}function c(t){e(i,o,a,s,c,"throw",t)}s(void 0)}))}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function i(e){return e?Array.from(e).reduce((e,t)=>{var n,{localName:r,value:a}=t;return o(o({},e),{},{[(n=r,n.replace(/(-)([a-z])/g,e=>e[1].toUpperCase()))]:a})},{}):{}}function s(e){return document.createRange().createContextualFragment(e)}function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Array.isArray(e)?e.reduce((e,t,r)=>e+(n[r]?t+n[r]:t),""):e,a=new CSSStyleSheet;return a.replace(o),a}function d(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Array.isArray(e)?e.reduce((e,t,r)=>e+(n[r]?t+n[r]:t),""):e;return s(o)}!function(){if(!("adoptedStyleSheets"in document)){var e="ShadyCSS"in window&&!window.ShadyCSS.nativeShadow,t=[],n=[],r=new WeakMap,o=new WeakMap,a=new WeakMap,i=new WeakMap,s=new WeakMap,c={loaded:!1},d={body:null,CSSStyleSheet:null},l=CSSStyleSheet,h=/@import\surl(.*?);/gi,u=["addImport","addPageRule","addRule","deleteRule","insertRule","removeImport","removeRule"],p=["replace","replaceSync"],m=function(){function e(){var e=document.createElement("style");c.loaded?d.body.appendChild(e):(document.head.appendChild(e),e.disabled=!0,t.push(e));var n=e.sheet;return o.set(n,{adopters:new Map,actions:[],basicStyleElement:e}),n}var n=e.prototype;return n.replace=function(e){var t=this,n=v(e);return new Promise((function(e,r){if(o.has(t)){var a=o.get(t).basicStyleElement;a.innerHTML=n,e(a.sheet),b(t)}else r(new Error("Can't call replace on non-constructed CSSStyleSheets."))}))},n.replaceSync=function(e){var t=v(e);if(o.has(this)){var n=o.get(this).basicStyleElement;return n.innerHTML=t,b(this),n.sheet}throw new Error("Failed to execute 'replaceSync' on 'CSSStyleSheet': Can't call replaceSync on non-constructed CSSStyleSheets.")},e}();Object.defineProperty(m,Symbol.hasInstance,{configurable:!0,value:f}),g(l.prototype),window.CSSStyleSheet=m,function(){var t={configurable:!0,get:function(){return r.get(this)||[]},set:function(e){var t=r.get(this)||[];!function(e,t){var n=t===document?"Document":"ShadowRoot";if(!Array.isArray(e))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+n+": Iterator getter is not callable.");if(!e.every(f))throw new TypeError("Failed to set the 'adoptedStyleSheets' property on "+n+": Failed to convert value to 'CSSStyleSheet'");var o=e.filter((function(t,n){return e.indexOf(t)===n}));r.set(t,o)}(e,this);var n=this===document?y()?this.head:this.body:this,a="isConnected"in n?n.isConnected:document.body.contains(n);window.requestAnimationFrame((function(){a&&(w(n),function(e,t){for(var n=S(e),r=0,a=t.length;r<a;r++)if(!(n.indexOf(t[r])>-1)){var s=o.get(t[r]).adopters,c=i.get(e),d=s.get(e);d||(d=s.get(document.head)),c.disconnect(),d.parentNode.removeChild(d),c.observe()}}(n,t))}))}};if(Object.defineProperty(Document.prototype,"adoptedStyleSheets",t),"undefined"!=typeof ShadowRoot){var n=Element.prototype.attachShadow;Element.prototype.attachShadow=function(){var t=e?this:n.apply(this,arguments);return _(t),t},Object.defineProperty(ShadowRoot.prototype,"adoptedStyleSheets",t)}}(),y()?document.addEventListener("DOMContentLoaded",M):M()}function f(e){return e instanceof l||e instanceof d.CSSStyleSheet}function y(){return"loading"===document.readyState}function S(e){return r.get(e.parentNode===document.documentElement?document:e)}function v(e){var t=e.match(h,"")||[],n=e;return t.length&&(console.warn("@import rules are not allowed here. See https://github.com/WICG/construct-stylesheets/issues/119#issuecomment-588352418"),t.forEach((function(e){n=n.replace(e,"")}))),n}function g(e){p.forEach((function(t){e[t]=function(){return m.prototype[t].apply(this,arguments)}})),u.forEach((function(t){var n=e[t];e[t]=function(){var e=arguments,r=n.apply(this,e);if(o.has(this)){var a=o.get(this),i=a.adopters,s=a.actions;i.forEach((function(n){n.sheet&&n.sheet[t].apply(n.sheet,e)})),s.push([t,e])}return r}}))}function b(e){var t=o.get(e),n=t.adopters,r=t.basicStyleElement;n.forEach((function(e){e.innerHTML=r.innerHTML}))}function w(e){for(var t=document.createDocumentFragment(),r=S(e),c=i.get(e),d=0,l=r.length;d<l;d++){var h=o.get(r[d]),u=h.adopters,p=h.basicStyleElement,m=u.get(e);m?(c.disconnect(),t.appendChild(m),(!m.innerHTML||m.sheet&&!m.sheet.cssText)&&(m.innerHTML=p.innerHTML),c.observe()):((m=document.createElement("style")).innerHTML=p.innerHTML,a.set(m,e),s.set(m,0),u.set(e,m),t.appendChild(m)),e===document.head&&n.push(m)}e.insertBefore(t,e.firstChild);for(var f=0,y=r.length;f<y;f++){var v=o.get(r[f]),g=v.adopters,b=v.actions,w=g.get(e),C=s.get(w);if(b.length>0){for(var _=C,M=b.length;_<M;_++){var E=b[_],P=E[0],O=E[1];w.sheet[P].apply(w.sheet,O)}s.set(w,b.length-1)}}}function C(t){for(var n=0,r=t.length;n<r;n++){for(var o=t[n],i=o.addedNodes,s=o.removedNodes,c=0,d=s.length;c<d;c++){var l=a.get(s[c]);l&&w(l)}if(!e)for(var h=0,u=i.length;h<u;h++)for(var p=document.createNodeIterator(i[h],NodeFilter.SHOW_ELEMENT,(function(e){return e.shadowRoot&&e.shadowRoot.adoptedStyleSheets.length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),null,!1),m=void 0;m=p.nextNode();)w(m.shadowRoot)}}function _(e){var t=new MutationObserver(C),n={observe:function(){t.observe(e,{childList:!0,subtree:!0})},disconnect:function(){t.disconnect()}};i.set(e,n),n.observe()}function M(){var e=document.createElement("iframe");e.hidden=!0,document.body.appendChild(e),d.body=e.contentWindow.document.body,d.CSSStyleSheet=e.contentWindow.CSSStyleSheet,g(e.contentWindow.CSSStyleSheet.prototype),_(document.body),c.loaded=!0;for(var r=document.createDocumentFragment(),o=0,a=t.length;o<a;o++)t[o].disabled=!1,r.appendChild(t[o]);d.body.appendChild(r);for(var i=0,s=n.length;i<s;i++)r.appendChild(n[i]);document.body.insertBefore(r,document.body.firstChild),t.length=0,n.length=0}}();var l={},h={};class u extends HTMLElement{constructor(e){super(),e?this.componentPath=e:(console.warn("You did not send a path to the super method in your constructor. Thus CSS and HTML cannot be read for this component.",this),console.warn("If shipping for modern browser, then call super with import.meta.url. If not, specify a path that is similar to import.meta.url yourself."),console.warn("Should be the path to the component you are making."))}$(e){return this._sDOM.querySelector(e)}get cssPath(){return this.componentPath&&this.componentPath.replace(/\.(html|js)/gi,".css")}get htmlPath(){return this.componentPath&&this.componentPath.replace(/\.(css|js)/gi,".html")}get props(){return i(this.attributes)}_render(){var e=this;return t((function*(){if(!h[e.cssPath]&&e.cssPath){var t=yield e.fetchCSSAsStyleSheet();e._sDOM.adoptedStyleSheets=[t]}return s(e.render(e.props))}))()}fetchHTMLAsDocFrag(){var e=this;return t((function*(){var t=yield fetch(e.htmlPath);if(t.ok)return s(yield t.text());throw new Error("Fetch failed")}))()}fetchCSSAsStyleSheet(){var e=this;return t((function*(){var t=new CSSStyleSheet,n=yield fetch(e.cssPath);if(n.ok&&-1!==n.headers.get("content-type").indexOf("text/css")){var r=yield n.text();yield t.replace(r)}return t}))()}_renderHTMLFile(){var e=this;return t((function*(){var t=btoa(e.componentPath);l[t]||(l[t]=Promise.all([e.fetchHTMLAsDocFrag(),e.fetchCSSAsStyleSheet()]));var[n,r]=yield l[t];return e._sDOM.adoptedStyleSheets=[r],n.cloneNode(!0)}))()}componentDidMount(){}connectedCallback(){var e=this;return t((function*(){var t;e._sDOM=e.attachShadow({mode:"closed"}),e.render?t=yield e._render():e.componentPath?t=yield e._renderHTMLFile():console.error("No render function or component path found for static html/css."),e._sDOM.innerHTML=null,e._sDOM.appendChild(t),requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.componentDidMount&&e.componentDidMount()})})}))()}}function p(e){var t=a("is"in e?e.is:e.prototype.constructor.name);return customElements.define(t,e),t}var m=[],f=new Map,y=new Map,S=new Map;function v(e,n){var{metaUrl:r,observedAttributes:o,kebabName:a}=n;return class extends HTMLElement{constructor(){super(),this._postRender=void 0,this._propsChanged=void 0,this._componentPath=r,document.addEventListener("esm-hmr:webact-function-component",()=>{e=f.get(a)?f.get(a):e,this._render()})}set _html(e){if(y.has(a))console.debug("The component already has template initialized. Keep updates in postRender.");else{var t=document.createElement("template");t.content.appendChild(e),y.set(a,t)}}get _html(){return y.get(a).content.cloneNode(!0)}set _css(e){S.has(a)?console.debug("The component already has stylesheet initialized. Keep updates in postRender."):S.set(a,e)}get _css(){return S.get(a)}get cssPath(){return this._componentPath&&this._componentPath.replace(/\.(html|js)/gi,".css")}get htmlPath(){return this._componentPath&&this._componentPath.replace(/\.(css|js)/gi,".html")}static get observedAttributes(){return o}_render(n){var r=this;return t((function*(){r._rendering=e.apply(r.customThis,[n]),r._rendering instanceof Promise&&(yield r._rendering),yield new Promise(e=>{r._css?requestAnimationFrame(()=>{r._sDOM.adoptedStyleSheets=[r._css]}):console.warn("Missing CSS. Will render without it."),r._html?requestAnimationFrame(()=>{r._sDOM.innerHTML=null,r._sDOM.appendChild(r._html)}):console.warn("Missing HTML. Will render without it."),e()}),r._postRender instanceof Function&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{r._postRender()})})}))()}get customThis(){var e,n,r=this;return{html:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r._html=d(e,...n),r._html},css:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r._css=c(e,...n),r._css},useHTML:(n=t((function*(e){if(e=e||r.htmlPath){e instanceof URL&&(e=e.toString());var t=yield fetch(e),n=yield t.text();return r.customThis.html([n])}})),function(e){return n.apply(this,arguments)}),useCSS:(e=t((function*(e){if(e=e||r.cssPath){e instanceof URL&&(e=e.toString());var t=yield fetch(e),n=yield t.text();return r.customThis.css([n])}})),function(t){return e.apply(this,arguments)}),postRender:e=>{this._postRender=e},propsChanged:e=>{this._propsChanged=e},$:e=>void 0===e?this:":host"===e?this._sDOM:this._sDOM.querySelector(e),$$:e=>this._sDOM.querySelectorAll(e)}}attributeChangedCallback(){var e=this;return t((function*(){yield e._rendering,requestAnimationFrame(()=>{e._propsChanged instanceof Function?e._propsChanged(i(e.attributes)):e._render(i(e.attributes))})}))()}connectedCallback(){var e=this;return t((function*(){e._sDOM=e.attachShadow({mode:"closed"}),e._render(i(e.attributes))}))()}}}function g(e){var{metaUrl:t,observedAttributes:n,name:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{metaUrl:void 0,observedAttributes:[],name:void 0},o=r||a(e.name);if(customElements.get(o)){if(!m.includes(o))throw new Error("\n        Some else has already registered <".concat(o,"> in the custom element registry.\n      "));f.set(o,e),document.dispatchEvent(new CustomEvent("esm-hmr:webact-function-component"))}else{var i=v(e,{metaUrl:t,observedAttributes:n,kebabName:o});customElements.define(o,i),m.push(o)}return o}export{u as Component,p as registerComponent,g as registerFunctionComponent};
//# sourceMappingURL=index.bundled.js.map
